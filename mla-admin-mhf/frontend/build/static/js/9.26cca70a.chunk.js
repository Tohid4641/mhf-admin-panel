(this.webpackJsonpmla=this.webpackJsonpmla||[]).push([[9],{1109:function(t,e,a){"use strict";a.r(e);var l=a(19),n=a(8),s=a(12),i=a(13),r=a(7),c=a(16),o=a(15),m=a(0),u=a.n(m),p=a(25),d=a(22),h=a(824),f=a(837),g=a(829),b=a(830),v=a(831),E=a(822),S=a(823),D=a(825),C=a(826),N=a(3),F=a.n(N),O=a(24),y=a.n(O),x=a(134),j=a(51),w=a.n(j),P=a(20),k=a.n(P),M=a(27),Y=(a(957),a(53)),L=a(11),A=a(62),_=a(872),T=(a(881),a(882),a(18)),I=a.n(T),R=function(t){Object(c.a)(a,t);var e=Object(o.a)(a);function a(t){var l;return Object(s.a)(this,a),(l=e.call(this,t)).updateValidators=function(t,e){l.validators[t].errors=[],l.validators[t].state=e,l.validators[t].valid=!0,l.validators[t].rules.forEach((function(a){a.test instanceof RegExp?a.test.test(e)||(l.validators[t].errors.push(a.message),l.validators[t].valid=!1):"function"===typeof a.test&&(a.test(e)||(l.validators[t].errors.push(a.message),l.validators[t].valid=!1))}))},l.isFormValid=function(){var t=!0;return Object.keys(l.validators).forEach((function(e){"complaintNumber"===e&&(l.validators[e].valid||(t=!1))})),t},l.displayValidationErrors=function(t){var e=l.validators[t];if(e&&!e.valid){var a=e.errors.map((function(t,e){return u.a.createElement("span",{className:"error",key:e},"* ",t,u.a.createElement("br",null))}));return u.a.createElement("div",{className:"col s12 row"},a)}return""},l.handleChange=function(t){l.setState({complaintFilterStatusSelected:t});var e=Object(n.a)(Object(n.a)({},l.props.complaintFilters),{},{status:t});l.props.updatingComplaintFilters(e),l.getFilterComplaints(e)},l.handleChange1=function(t){l.setState({complaintFilterPublishSelected:t});var e=Object(n.a)(Object(n.a)({},l.props.complaintFilters),{},{publish:t});l.props.updatingComplaintFilters(e),l.getFilterComplaints(e)},l.updateDateFilter=function(t,e){var a=Object(n.a)(Object(n.a)({},l.props.complaintFilters),{},{date:{startDate:t,endDate:e}});l.props.updatingComplaintFilters(a),l.getFilterComplaints(a)},l.complaintNumber=function(t){var e=l.state.complaintNumber;l.setState({authenticating:!0});var a=Object(r.a)(l);l.setState({updatingStatus:!0}),F.a.all([L.a.complaintNumber(e,l.props.match.params.complaint_id,t)]).then((function(t){if(t[0]){var e=t[0].data;e.status&&e.data?(a.props.history.push("/complaints/"+e.data._id),a.setState({authenticating:!1})):(a.setState({apiError:e.message}),a.setState({authenticating:!1}))}})).catch((function(t){console.log(t),t.message&&console.log("An error occurred in change Password")}))},l.getComplaints=function(t){var e=Object(r.a)(l);e.setState({fetchingDetails:!0}),F.a.all([L.a.getComplaints(t)]).then((function(t){if(t[0]){var a=t[0].data,l=(a.data?a.data:[]).map((function(t,e){return{id:t._id,details:{index:e,id:t._id,title:t.complaintTitle,description:t.complaintDescription,status:t.complaintStatus,date:y()(t.createdAt).format("Do MMM YYYY hh:mm A")}}}));e.setState({complaintsList:l,complaintsMain:l})}e.setState({fetchingDetails:!1})})).catch((function(t){console.log(t),t.message&&console.log("An error occurred in complaint list")}))},l.getFilterComplaints=function(t){var e=t&&t.status&&t.status.value?t.status.value:"All",a=t&&t.publish&&t.publish.value?t.publish.value:"All";"UnPublish"===a&&(a="");var n=t&&t.date&&t.date.startDate?y()(t.date.startDate).format("YYYY-MM-DD"):null,s=t&&t.date&&t.date.endDate?y()(t.date.endDate).format("YYYY-MM-DD"):null,i=Object(r.a)(l);i.setState({fetchDetails:!0}),F.a.all([L.a.complaintsFilter(e,a,n,s)]).then((function(t){if(t[0]){var e=t[0].data;console.log(e.data);var a=(e.data?e.data:[]).map((function(t,e){return{id:t._id,details:{index:e,id:t._id,title:t.complaintTitle,description:t.complaintDescription,complaintPublish:t.complaintPublish,status:t.complaintStatus,date:y()(t.createdAt).format("Do MMM YYYY hh:mm A")}}}));i.setState({complaintsList:a,complaintsMain:a})}i.setState({fetchDetails:!1})})).catch((function(t){console.log(t),t.message&&console.log("An error occurred in complaint list")}))},l.formatComplaint=function(t,e){return u.a.createElement(d.c,{to:l.props.match.path+"/"+t.id,className:"mlac-each"},u.a.createElement("div",{className:"mlace-head"},u.a.createElement("span",null,t.title),u.a.createElement("span",{className:"mlacer-date"},t.date),u.a.createElement("span",{className:"mlac-status"},u.a.createElement("span",{className:"".concat("Pending"===t.status?"status-pending":""," ").concat("In Progress"===t.status?"status-inprogress":""," ").concat("Closed"===t.status?"status-closed":"")},t.status))),u.a.createElement("span",{className:"mlace-content",sm:12},t.description))},l.filterComplaints=function(t){var e=l.state.searchText;t&&(e=t.target.value);var a=[];a=e&&e.length>=2?l.state.complaintsMain.filter((function(t){return t.details.status.toLowerCase().indexOf(e.toLowerCase())>-1||t.details.description.toLowerCase().indexOf(e.toLowerCase())>-1||t.details.title.toLowerCase().indexOf(e.toLowerCase())>-1})):l.state.complaintsMain,l.setState({searchText:e,complaintsList:a})},l.DateRangePicker=function(){},l.onChange=l.onChange.bind(Object(r.a)(l)),l.handleSubmit=l.handleSubmit.bind(Object(r.a)(l)),l.DateRangePicker=l.DateRangePicker.bind(Object(r.a)(l)),l.state={startDate:null,endDate:null,published:"",apiError:"",modal:!1,complaintNumber:"",id:"",apiSuccess:"",authenticating:!1,complaintsList:[],complaintsMain:[],searchText:"",fetchingDetails:!1,fetchDetails:!1,complaintFilterStatusOptions:[{label:u.a.createElement(I.a,{content:"all"}),value:"All"},{label:u.a.createElement(I.a,{content:"pending"}),value:"Pending"},{label:u.a.createElement(I.a,{content:"in progress"}),value:"In Progress"},{label:u.a.createElement(I.a,{content:"closed"}),value:"Closed"}],complaintFilterStatusSelected:{label:u.a.createElement(I.a,{content:"all"}),value:"All"},complaintStatusOptions:[{label:u.a.createElement(I.a,{content:"all"}),value:"All"},{label:u.a.createElement(I.a,{content:"publish"}),value:"Publish"},{label:u.a.createElement(I.a,{content:"unpublish"}),value:"UnPublish"}],complaintFilterPublishSelected:{label:u.a.createElement(I.a,{content:"all"}),value:"All"}},l.validators=Y.a,l.toggle=l.toggle.bind(Object(r.a)(l)),l}return Object(i.a)(a,[{key:"toggle",value:function(){this.setState({modal:!this.state.modal,authenticating:!1,apiError:""})}},{key:"onChange",value:function(t){this.setState(Object(l.a)({},t.target.name,t.target.value)),this.updateValidators([t.target.name],t.target.value)}},{key:"handleSubmit",value:function(t){t.preventDefault(),this.setState({authenticating:!0}),this.complaintNumber()}},{key:"componentDidMount",value:function(){var t=this.props.complaintFilters;t&&(t.status&&this.setState({complaintFilterStatusSelected:t.status}),t.publish&&this.setState({complaintFilterPublishSelected:t.publish}),t.date&&(this.setState({startDate:t.date.startDate}),this.setState({endDate:t.date.endDate}))),this.getFilterComplaints(t)}},{key:"render",value:function(){var t=this,e=this.props.complaintFilters,a=this.state,l=a.complaintsList,n=a.fetchingDetails,s=a.fetchDetails,i=a.complaintFilterStatusOptions,r=a.complaintStatusOptions,c=a.complaintFilterPublishSelected,o=a.complaintFilterStatusSelected,m=a.authenticating,d=a.apiSuccess,N=a.apiError;return u.a.createElement("div",{className:"col-span-12 mla-complaints"},u.a.createElement("div",{className:"col-span-12 xxl:col-span-9"},u.a.createElement("div",{className:"intro-y flex items-end mt-10 mb-10"},u.a.createElement("h2",{className:"text-lg text-black font-medium"},"Complaints"),u.a.createElement(h.a,{md:4,className:"ml-auto"},u.a.createElement("div",{style:{float:"right"}},u.a.createElement("i",{className:"fa fa-refresh ",onClick:function(){t.getFilterComplaints(e)}}),"\xa0\xa0\xa0\xa0",u.a.createElement("i",{className:"fa fa-search ",onClick:this.toggle}))),u.a.createElement(f.a,{isOpen:this.state.modal,className:"search-popup",style:{marginTop:"50px",marginLeft:"auto"}},u.a.createElement(g.a,{style:{backgroundColor:"#253c80",color:"white"},toggle:this.toggle},u.a.createElement(I.a,{content:"search by complaint number"})," "),u.a.createElement(b.a,null,""!==d&&u.a.createElement("div",{className:"errormsg"},u.a.createElement(v.a,{color:"danger"},d)),u.a.createElement(w.a,{onSubmit:this.handleSubmit},u.a.createElement("div",null,u.a.createElement("label",null," ",u.a.createElement(I.a,{content:"complaint number"})," "),u.a.createElement(k.a,{type:"text",name:"complaintNumber",className:"input w-full border mt-2 form-control",placeholder:"Complaint Number",onChange:this.onChange,value:this.state.complaintNumber}),this.displayValidationErrors("complaintNumber")),N&&""!==N&&u.a.createElement("span",{className:"search_error"},N),m?u.a.createElement("i",{className:"fa fa-spin fa-refresh authentication-loading"}):u.a.createElement(E.a,{className:" btn btn-primary mt-3",color:"primary",type:"submit",disabled:!this.isFormValid()},u.a.createElement("span",{className:"text-white"},u.a.createElement(I.a,{content:"submit"})," "))))))),u.a.createElement(S.a,{className:"intro-y"},u.a.createElement(S.a,{className:"complaint-filters"},u.a.createElement(x.a,{name:"mlac-status-filter",className:"selectbox mlac-status-filter w-full flex-1",onChange:this.handleChange,placeholder:"Status Filter",options:i,value:o,isSearchable:!0,style:{border:"none !important"},isLoading:s,isDisabled:s}),u.a.createElement(x.a,{name:"mlac-status-filter",className:"selectbox mlac-status-filter w-full flex-1",onChange:this.handleChange1,placeholder:"Status Filter",options:r,value:c,isSearchable:!0,style:{border:"none !important"},isLoading:s,isDisabled:s}),u.a.createElement("div",{className:"date-filter"},u.a.createElement(_.DateRangePicker,{enableOutsideDays:!0,isOutsideRange:function(){return!1},isDayHighlighted:function(t){return t.isSame(new Date,"d")},startDate:this.state.startDate,className:"date-filter",endDate:this.state.endDate,focusedInput:this.state.focusedInput,onFocusChange:function(e){return t.setState({focusedInput:e})},onDatesChange:function(e){var a=e.startDate,l=e.endDate;t.setState({startDate:a,endDate:l}),t.updateDateFilter(a,l)}}))),n?u.a.createElement("i",{className:"fa fa-spin fa-refresh initial_loading"}):u.a.createElement(h.a,{sm:!0,md:!0,lg:12,className:"mb-30"},u.a.createElement(D.a,{className:"card-statistics h-100"},u.a.createElement(S.a,{className:"mlac-search-container"},u.a.createElement(h.a,{xs:12,sm:12,md:6,lg:12},u.a.createElement("input",{className:"form-control mlac-search",value:this.state.field_search_input,placeholder:"Search",onChange:this.filterComplaints,onKeyDown:this.filterComplaints,ref:function(e){t.searchInput=e}}))),u.a.createElement(C.a,null,u.a.createElement(p.BootstrapTable,{data:l,pagination:!0,striped:!0,condensed:!0},u.a.createElement(p.TableHeaderColumn,{className:"mlac-row",dataField:"details",dataFormat:this.formatComplaint,isKey:!0})))))))}}]),a}(u.a.Component);e.default=Object(M.b)((function(t){return{complaintFilters:t.auth.complaintFilters}}),(function(t){return{updatingComplaintFilters:function(e){t(Object(A.f)(e))}}}))(R)},957:function(t,e,a){}}]);
//# sourceMappingURL=9.26cca70a.chunk.js.map